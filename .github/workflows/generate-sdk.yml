name: Generate Go SDK
on: push
jobs:
  generate-clients:
    runs-on: ubuntu-latest
    name: Generate Go SDK
    steps:
      # Checkout the repository
      - uses: actions/checkout@v3

      # Cleanup old client
      - name: Cleanup old Go client
        run: rm -rf go-client/

      # Generate new Go client
      - name: Generate Go SDK
        uses: openapi-generators/openapitools-generator-action@v1
        with:
          generator: go
          input-spec: https://raw.githubusercontent.com/Crspy2/developers/main/api-reference/openapi.json
          additional-properties: packageName=sellix

      # Commit new client
      - name: Commit new client
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          git config --global user.name 'Crspy2'
          git config --global user.email 'crspy8687@gmail.com'
          git add go-client/
          git commit -am "Update Go SDK client"
          git push
